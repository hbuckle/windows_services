$ErrorActionPreference = "Stop"
$username = '<%= @username %>'
$password = '<%= @password %>'
$privilege = "SeServiceLogonRight"
[Reflection.Assembly]::LoadFile("<%= @carbondll %>")
[Carbon.LSA]::GrantPrivileges($username, $privilege)
$serverName = $env:COMPUTERNAME
$service = '<%= @servicename %>'
$svc = Get-CimInstance Win32_Service -Filter -ComputerName $serverName -filter "Name='$service'"
$svc | Invoke-CimMethod -MethodName "StopService" | Out-Null
$arguments = ($null,$null,$null,$null,$null,$null,$username,$password,$null,$null,$null)
$svc | Invoke-CimMethod -MethodName "Change" -Arguments $arguments | Out-Null
$svc | Invoke-CimMethod -MethodName "StartService" | Out-Null